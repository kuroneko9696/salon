# 社内向け 展示会用名刺管理Webアプリ 仕様書

## 1. プロジェクト概要

展示会での名刺交換と、それに付随する商談情報を効率的に管理・共有するための社内向けWebアプリケーションを開発する。

## 2. 目的とターゲット

* **目的:**
    * 展示会で獲得した名刺情報（画像・テキスト）と、その場の会話（熱量、ニーズ）を紐付けてデータベース化する。
    * 情報の粒度を統一し、営業担当者以外（開発部門など）でも顧客ニーズを把握できるようにする。
    * LLMを活用し、営業活動の事前準備（企業研究、アプローチ提案）を効率化する。
* **ターゲットユーザー:**
    * 展示会で顧客対応をする営業担当者、エンジニア。
    * 獲得したリード情報を閲覧・分析するマネージャー、マーケティング担当者。
* **利用シーン:**
    * （主）展示会場での名刺交換直後。
    * （副）展示会後のフォローアップ時。

## 3. 想定プラットフォーム

* **種別:** Webアプリケーション (PWA推奨)
* **主要デバイス:** Android スマートフォン
* **主要ブラウザ:** Google Chrome (最新版)
* **必須API:**
    * `getUserMedia` (カメラ制御用)　→　スマホ（AndroidPixel9aを想定。できるだけ高解像度で撮影したい）
    * Service Worker (オフライン対応用)
    * LLM API (Vision対応モデル。Gemini)
    * LLM API (Web検索・分析対応モデル。例: Gemini 2.5 )

* **技術スタック** 
    * Docker-compose
    * github (ソース管理)
    * Vercel (デプロイ)
    * FrontEnd : Next.js
        * tailwind /shadCN
    * back end : Fast API (python)　-> LLM API使用
    * db : firebase (google) // MVPではモック


## 4. 機能要件

### 4.1. 認証

* 社内利用を前提としたシンプルな認証（例: Google Workspace認証、ID/PW認証）を実装する。

### 4.2. 名刺一覧 (ダッシュボード)

* **概要:** 登録された名刺情報を一覧表示する。
* **UI:**
    * ヘッダーに検索バーを配置する。
    * 名刺情報をカード形式（スキャン画像サムネイル、氏名、会社名）でリスト表示する。
    * 名刺登録フローを開始するためのFAB（フローティングアクションボタン）を配置する。
* **機能:**
    * **検索:** 氏名、会社名、部署名などでインクリメンタル検索（または全文検索）ができる。
    * **遷移:** カードをタップすると「4.4. 名刺・商談情報詳細」画面に遷移する。

### 4.3. 名刺登録フロー

一連の画面遷移で名刺登録を完結させる。

#### 4.3.1. [画面1] カメラ撮影

* **UI:**
    * サイトを開く（または一覧画面のFABを押す）と本画面に遷移する。
    * 画面上半分（または全画面）にカメラプレビューを表示する。
    * 名刺を収めるためのガイド枠（四角形）をオーバーレイ表示する。
    * 画面下部に「撮影」ボタンを配置する。
* **機能:**
    * `getUserMedia` を使用し、デバイスの背面カメラを起動する。
    * 「撮影」ボタンタップで画像をキャプチャし、「4.3.2. プレビュー確認」画面に遷移する。

#### 4.3.2. [画面2] プレビュー確認

* **UI:**
    * 撮影された画像を表示する。
    * 「スキャン」ボタンを配置する。
    * 「再撮影」ボタンを配置する。
* **機能:**
    * ユーザーは画像が「枠内に収まっているか」「手ブレがないか」「ピンボケしていないか」を確認する。
    * 「再撮影」ボタンタップで「4.3.1. カメラ撮影」画面に戻る。
    * 「スキャン」ボタンタップで「4.S1. LLMスキャン処理」を実行し、「4.3.3. スキャン結果修正」画面に遷移する。

#### 4.S1. [処理] LLMスキャン処理 (OCR)

* **トリガー:** 「スキャン」ボタンタップ時。
* **処理:**
    * 撮影画像をVision対応LLM APIに送信する。
    * **プロンプト指示 (例):**
        * 「これは名刺の画像です。以下の項目をJSON形式で抽出してください。」
        * 「`company_name`: 会社名」
        * 「`departments`: 部署名 (部、課、グループなど。複数ある場合は配列で)」
        * 「`titles`: 役職 (複数ある場合は配列で)」
        * 「`full_name`: 氏名」
        * 「`name_reading`: 氏名のローマ字またはフリガナ (存在する場合のみ)」
        * 「`email`: メールアドレス」
        * 「`company_url`: 会社URL」
        * 「`address`: 会社住所」
        * 「注意事項: 画像に含まれない項目は `null` または空文字としてください。推測や補完はしないでください。」
* **考慮点:** この処理には数秒かかる可能性があるため、ローディングインジケーターを表示する。

#### 4.3.3. [画面3] スキャン結果修正

* **UI:**
    * 画面上部に、撮影した名刺画像（確認用）を表示する。
    * 画面下部に、LLMが抽出したデータを入力フォームとして表示する。
    * 各フォーム（会社名、氏名、部署名、役職など）は編集可能であること。
    * 「更新して商談メモへ」ボタン（または「更新」ボタン）を配置する。
* **機能:**
    * ユーザーはLLMの抽出結果を確認し、誤りがあれば手動で修正する。
    * 「更新して商談メモへ」ボタンタップで、名刺情報（画像含む）とフォーム内容をデータベースに書き込む。
    * 書き込み完了後、「4.3.4. 商談管理 (アンケート)」画面に自動遷移する。

#### 4.3.4. [画面4] 商談管理 (アンケート)

* **UI:** 設問に基づいた選択式フォーム（ラジオボタン、チェックボックス）およびテキストエリアを配置する。
* **機能:**
    * 展示会での会話内容をアンケート形式で入力する。
    * 「保存」ボタンタップで、アンケート内容を該当の名刺情報に紐づけてデータベースに保存する。
    * 保存後、「4.2. 名刺一覧」画面に遷移する。

* **アンケート項目 (固定):**

    **Q1. 最も関心を示した技術デモ (複数選択可)**
    * [ ] デモA: (例: AI画像認識ソリューション)
    * [ ] デモB: (例: 高速データ処理基盤)
    * [ ] デモC: (例: AR/MRシミュレーション)
    * [ ] デモD: (その他)
    * [ ] その他 ( ※自由記述 )

    **Q2. 顧客の主な課題・ニーズ (複数選択可)**
    * [ ] 既存業務の自動化・効率化
    * [ ] 新規事業・サービスのアイディア実現
    * [ ] データ活用・分析基盤の構築
    * [ ] 技術的なR&Dパートナー探索
    * [ ] DX推進のコンサルティング
    * [ ] その他 ( ※自由記述 )

    **Q3. 関心の背景・具体的な相談内容 (単一選択)**
    * ( ) A: 自社の「〇〇(※)」に活用できそう (※自由記述入力欄)
    * ( ) B: 既存ベンダーからのリプレイス検討
    * ( ) C: R&Dテーマとして情報収集中
    * ( ) D: 具体的な相談はまだない (情報収集)

    **Q4. 顧客の熱量・反応 (単一選択)**
    * ( ) A: 非常に高い (ぜひ提案・見積もりが欲しい)
    * ( ) B: 高い (一度、技術詳細や活用事例の紹介に来てほしい)
    * ( ) C: 普通 (関連資料が欲しい)
    * ( ) D: 低い (挨拶・名刺交換のみ)

    **Q5. 協業・案件化の可能性 (単一選択)**
    * ( ) 高: 具体的な予算・時期の相談あり
    * ( ) 中: 課題は明確だが、時期・予算は未定
    * ( ) 低: 情報交換レベル
    * ( ) 不明

    **Q6. 時期感 (Q5で「高」の場合のみ表示 / 単一選択)**
    * ( ) すぐにでも (3ヶ月以内)
    * ( ) 半年以内
    * ( ) 1年以内
    * ( ) 未定

    **Q7. 次のアクション (単一選択)**
    * ( ) アポ設定済み (※日付入力欄)
    * ( ) 後日アポ調整 (こちらから連絡)
    * ( ) 技術詳細資料・事例集の送付
    * ( ) PoC (概念実証) の提案
    * ( ) 御礼メールのみ

    **【自由記述欄】**
    * **特記事項・会話メモ:** (テキストエリア)

### 4.4. 名刺・商談情報詳細

* **UI:**
    * タブUI（または類似の切り替えUI）を採用する。
    * **タブ1: 名刺情報:**
        * 名刺スキャン画像（フルサイズ）。
        * スキャン結果のテキストデータ（読み取り専用）。
        * （編集ボタンを設け、「4.3.3. スキャン結果修正」画面に遷移しても良い）
    * **タブ2: 商談メモ (アンケート):**
        * 「4.3.4. 商談管理 (アンケート)」で入力された結果（読み取り専用）。
        * （編集ボタンを設けても良い）
    * **タブ3: Deepリサーチ:**
        * 「4.5. Deepリサーチ機能」の実行ボタンと結果表示エリア。

### 4.5. Deepリサーチ機能 (LLMレポート)

* **目的:** 熱量の高い顧客に対し、LLMによる詳細な企業分析とアプローチ提案を提供する。
* **実行トリガー:**
    * 「4.4. 名刺・商談情報詳細」画面の「Deepリサーチ」タブ内に配置された「**レポート生成実行**」ボタンをユーザーが**手動**でタップする。
    * **実行条件:** アンケート(Q4)の熱量が「A: 非常に高い」または「B: 高い」の顧客に対してのみ、ボタンをアクティブ化する（推奨）。
* **処理 (非同期):**
    * ボタンタップ後、バックグラウンドで処理を実行する。UI上では「生成中です…」などのインジケーターを表示する。
* **処理フロー (RAG):**
    1.  **内部データ取得:** DBから名刺情報（特に会社名、会社URL）とアンケート結果（特に関心デモ、課題、熱量）を取得。
    2.  **外部データ検索:** 会社名、会社URLをキーに、Web検索API (Google Search APIなど) またはLLMのブラウジング機能で、企業の公式サイト、最新プレスリリース、IR情報、関連する業界ニュースを収集する。
    3.  **LLM分析・生成:** 高性能LLM（Gemini 1.5 Proなど）に対し、内部データと外部データをインプットとして与え、以下の構成でレポートを生成させる。
* **レポート出力UI:**
    * 「Deepリサーチ」タブ内に、生成されたレポートをMarkdown形式でレンダリング（表示）する。

* **レポート構成 (LLMへの指示概要):**

    **1. 企業概要（サマリー）**
    * （Web検索結果から事業内容、ビジネスモデル、主要ターゲットを要約）

    **2. 直近の動向（Web検索結果）**
    * （最新ニュース、プレスリリース、業界トレンドを要約）

    **3. 接触状況と推定ニーズ（LLM分析）**
    * **接触デモ:** [アンケートQ1の回答を挿入]
    * **顧客の課題:** [アンケートQ2, Q3の回答を挿入]
    * **推定ニーズ（LLM分析）:**
        * （「1. 企業概要」「2. 直近の動向」と「接触デモ」「顧客の課題」を関連付け、顧客がデモに関心を持った具体的な理由や、現在抱えているであろう喫緊の課題を推論・記述させる）

    **4. 推奨アプローチ（次のアクション案）**
    * （「3. 推定ニーズ」に基づき、次回の御礼メールやアポで言及すべき具体的な論点、ヒアリングすべき項目を提案させる）

## 5. データモデル (簡易スキーマ)

### 5.1. `Users`
* `user_id` (PK)
* `name`
* `email`
* (認証情報)

### 5.2. `BusinessCards` (名刺)
* `card_id` (PK)
* `user_id` (FK: 登録者)
* `image_url` (スキャン画像)
* `company_name`
* `departments` (TEXT or JSON)
* `titles` (TEXT or JSON)
* `full_name`
* `name_reading`
* `email`
* `company_url`
* `address`
* `created_at`
* `updated_at`

### 5.3. `Meetings` (商談メモ)
* `meeting_id` (PK)
* `card_id` (FK: 紐づく名刺)
* `q1_demo` (TEXT or JSON)
* `q2_needs` (TEXT or JSON)
* `q3_background` (TEXT)
* `q3_background_memo` (TEXT)
* `q4_heat_level` (TEXT: A/B/C/D)
* `q5_potential` (TEXT: 高/中/低/不明)
* `q6_timeframe` (TEXT)
* `q7_next_action` (TEXT)
* `q7_action_date` (DATE)
* `memo` (TEXT: 特記事項)
* `created_at`
* `updated_at`

### 5.4. `Reports` (Deepリサーチ)
* `report_id` (PK)
* `card_id` (FK: 紐づく名刺)
* `status` (TEXT: pending/processing/completed/failed)
* `content` (TEXT: 生成されたレポート本文 - Markdown)
* `created_at`
* `updated_at`

## 6. 非機能要件

* **パフォーマンス:**
    * 名刺スキャン（LLM OCR）処理は、体感で10秒以内に完了することが望ましい。（難しい場合は非同期処理を検討）
    * Deepリサーチ機能は非同期とし、ユーザーを待たせないこと。
* **オフライン対応 (必須):**
    * 展示会場の劣悪なネットワーク環境を想定する。
    * Service Workerを使用し、名刺画像、スキャン結果、アンケート入力をローカル（IndexDBなど）に一時保存する。
    * ネットワーク接続